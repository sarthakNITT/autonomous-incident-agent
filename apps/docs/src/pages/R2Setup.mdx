
# R2 Storage Setup

Due to Vercel's immutable file system and generic artifact storage limits, AIA uses **Cloudflare R2** for storing persistent data like investigation reports, diagrams, and memory snapshots.

## Why R2?

- **Low Cost**: Zero egress fees.
- **S3 Compatible**: Easy to integrate using standard S3 SDKs.
- **Performance**: Edge caching for fast retrieval.

## Setup Instructions

### 1. Create a Bucket

1.  Log in to the [Cloudflare Dashboard](https://dash.cloudflare.com/).
2.  Navigate to **R2**.
3.  Click **Create Bucket**.
4.  Name your bucket (e.g., `aia-artifacts-storage`).
5.  Choose a region close to your agent's deployment.

### 2. Generate API Keys

1.  In the R2 dashboard, click **Manage R2 API Tokens**.
2.  Click **Create API Token**.
3.  Name the token (e.g., `aia-agent-token`).
4.  **Permissions**: Select **Object Read & Write**.
5.  **Scope**: Limit to the specific bucket you created.
6.  Click **Create Token**.

### 3. Configure Agent

Copy the `Access Key ID`, `Secret Access Key`, and the `Enpoint` URL. Add them to your environment variables or `aia.config.ts`:

```env
# .env
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
R2_BUCKET_NAME=aia-artifacts-storage
R2_ACCOUNT_ID=your_account_id
```

The agent will now automatically use this bucket to store generated artifacts.

## Folder Structure in Bucket

The agent organizes files as follows:

```
/
├── incidents/
│   ├── incident-123/
│   │   ├── report.md
│   │   ├── diagram.png
│   │   └── trace.json
└── memory/
    └── embedding-index.bin
```
