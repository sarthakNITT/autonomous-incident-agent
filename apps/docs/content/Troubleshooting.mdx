# Troubleshooting

This guide addresses common issues encountered when running AIA.

## Incident Detection

### Agent Not Receiving Events

**Symptom**: Application errors occur, but no incident is created.

**Checks**:
1.  **Endpoint**: Ensure `OTEL_EXPORTER_OTLP_ENDPOINT` points to `http://localhost:3001` (Router) or `http://aia-agent:3001` (Docker).
2.  **Sampling**: Check if your OTel SDK is sampling out the error (set `OTEL_TRACES_SAMPLER=always_on` for debugging).
3.  **Logs**: Check `apps/router` logs. You should see `Span received: <traceId>`.

### False Positives

**Symptom**: AIA creates incidents for expected errors (e.g., 404s).

**Fix**:
-   Adjust the detection logic in `aia.config.ts` (if supported) or filter spans in your application before exporting.

## Remediation

### Autopsy Failed

**Symptom**: Incident stays in `ANALYZING` state forever.

**Checks**:
1.  **LLM Key**: Verify `AIA_API_KEY` is valid.
2.  **Git Access**: Ensure the agent can clone the repo to read source code. Check `apps/git-service` logs for authentication errors.

### Patch Verification Failed

**Symptom**: Incident moves to `FAILED` state with "Repro failed".

**Cause**:
-   **Hallucinated Repro**: The agent generated a test that doesn't actually fail on the original code.
-   **Broken Patch**: The patch caused a syntax error or failed the test.

**Fix**:
-   Check the `repro.ts` artifact in R2 to see what the agent tried to run.
