# R2 Storage Setup

AIA uses **Cloudflare R2** for storing persistent data like investigation reports, diagrams, and memory snapshots. This avoids filesystem limitations in serverless environments.

## Why R2?

*   **S3 Compatibility**: Works with standard AWS SDKs.
*   **Zero Egress Fees**: Cost-effective for high-volume trace data.
*   **Edge Performance**: Low latency for global agents.

## Setup Instructions

### 1. Create a Bucket

1.  Log in to the [Cloudflare Dashboard](https://dash.cloudflare.com/).
2.  Navigate to **R2**.
3.  Click **Create Bucket**.
4.  Name your bucket (e.g., `aia-artifacts`).

### 2. Generate API Keys

1.  Click **Manage R2 API Tokens**.
2.  Click **Create API Token**.
3.  Permissions: **Object Read & Write**.
4.  Copy the `Access Key ID`, `Secret Access Key`, and `Endpoint`.

### 3. Configure Agent

Add these to your environment variables:

<Tabs defaultValue="bash">
  <TabsList>
    <div className="flex items-center rounded-[4px] bg-[#18181b] p-0.5 border border-zinc-800/50">
      <TabsTrigger value="bash">bash</TabsTrigger>
    </div>
    <TabsCopyButton />
  </TabsList>
  <TabsContent value="bash">
    ```bash
    R2_ACCESS_KEY_ID=your_id
    R2_SECRET_ACCESS_KEY=your_secret
    R2_BUCKET=aia-artifacts
    R2_ENDPOINT=https://<accountid>.r2.cloudflarestorage.com
    ```
  </TabsContent>
</Tabs>

And ensuring your `aia.config.ts` maps them correctly:

```typescript
storage: {
  provider: "r2",
  bucket: process.env.R2_BUCKET,
  // ...
}
```
